$(document).ready(function(){var t=0;$(".variant").click(function(t){t.preventDefault(),$(this).addClass("active").siblings().removeClass("active");var a=$(this).children("a").attr("data-option-variant"),e=$(this).children("a").attr("data-option-price");$("input[name=variant]").val(a),$("input[name=price]").val(e)}),$(".input-qty").focus(function(){t=$(this).val()}),$(".input-qty").change(function(){var a=$(this).attr("id"),e=$(this).attr("data-variant"),n=$(this).val(),i=$(this).attr("max"),r=$("#input-csrf").val();if(parseInt(n)>parseInt(i))return $('[data-variant="'+e+'"]').val(t),$("#stock-error").html(parseInt(i)),$(".alert-box").show(),!1;$.post("cart",{id:a,action:"add",quantity:n,csrf:r}).done(function(t){location.reload(!0)})}),$(".close").click(function(t){t.preventDefault(),$(".alert-box").hide()}),$("#add-cart").click(function(t){t.preventDefault(),$(this).html("adding..."),$(this).attr("disabled","disabled"),sessionStorage.setItem("cart","true");var a=$("[name=uri]").val(),e=$("[name=variant]").val(),n=$("[name=csrf]").val();$.post("cart",{uri:a,variant:e,action:"add",csrf:n}).done(function(t){document.location.replace("cart")})});var a=StripeCheckout.configure({key:$("#checkout-key").val(),image:"../assets/images/logo.png",locale:"auto",token:function(t,a){$(".loading").show();var e=$("#input-csrf").val(),n=[];$(".input-qty:visible").each(function(t,a){var e={id:a.id,sku:a.getAttribute("data-sku"),quantity:a.value,price:a.getAttribute("data-amount"),name:a.getAttribute("data-name"),variant:a.getAttribute("data-variant")};n.push(e)});var i=parseInt($("#checkout-total").val());$.post("order",{token:JSON.stringify(t),args:JSON.stringify(a),csrf:e,items:JSON.stringify(n),total:i}).done(function(t){document.location.replace("order")})}});document.getElementById("checkoutButton").addEventListener("click",function(t){a.open({name:"the Invisible Cities",description:$("#checkout-content").val(),zipCode:!0,currency:"CAD",shippingAddress:!0,billingAddress:!0,amount:parseInt($("#checkout-total").val())}),t.preventDefault()}),window.addEventListener("popstate",function(){a.close()}),$("#terms").click(function(t){t.preventDefault(),$("#term-details").toggle()})});